<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>ç¬¬å››é—œä»‹ç´¹ - å®¢å»³</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
  <script>window.ASSETS_ROOT = "/";</script>
  <script src="js/core/audio-unlocker.js"></script>
  <style>
    :root{
      --overlay: rgba(0,0,0,.38);
      --glass: rgba(255,255,255,.08);
      --bd: rgba(255,255,255,.18);
      --accent: #ffd166;
      --safe-bottom: env(safe-area-inset-bottom);
    }

    /* èƒŒæ™¯èˆ‡æ·¡å…¥ */
    body{
      margin:0; color:#fff;
      background:#000 url("assets/images/game_bg4.png") center/cover no-repeat fixed;
      opacity:0; transition:opacity .45s ease;
      -webkit-tap-highlight-color: transparent;
    }
    body.ready{ opacity:1; }

    /* ç‰ˆå¿ƒèˆ‡å¡ç‰‡ */
    .wrap{ max-width:980px; margin:0 auto; padding:clamp(.8rem,2.8vw,1.25rem); }
    section{
      margin:clamp(.75rem,2.2vw,1.2rem) 0;
      padding:clamp(.75rem,2.5vw,1.15rem);
      border-radius:16px;
      background:var(--overlay);
      border:1px solid rgba(255,255,255,.16);
      backdrop-filter: blur(4px);
      box-shadow:0 8px 26px rgba(0,0,0,.35);
    }
    h1{ text-align:center; margin:.25rem 0 1rem; }
    h2{ text-align:center; margin:.2rem 0 .6rem; }

    /* éµå¸½æ¨£å¼ï¼ˆè§¸æ§æ›´å¤§ï¼‰ */
    .kbd{
      display:inline-block; padding:.18rem .48rem;
      border:1px solid #aaa; border-radius:8px;
      background:#fff; color:#111;
      font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:.95rem;
    }
    @media (max-width:640px){ .kbd{ padding:.28rem .58rem; border-width:2px; font-size:1rem; } }

    /* èŸ‘è‚å¡ç‰‡ RWD */
    .bug{ display:grid; grid-template-columns:1fr; gap:12px; align-items:center; }
    @media (min-width:760px){
      .bug{ grid-template-columns:320px 1fr; gap:18px; }
    }
    .bug img{
      width:100%; height:auto; display:block;
      border-radius:14px; background:var(--glass);
      border:1px solid var(--bd); padding:.25rem;
    }

    /* ä¸»è¦è¡Œå‹•æŒ‰éˆ•ï¼ˆæ¡Œæ©Ÿç½®ä¸­ï¼›æ‰‹æ©Ÿ stickyï¼‰ */
    .cta-wrap{ text-align:center; margin-top:1.2rem; }
    #startBtn{
      appearance:none; border:0; cursor:pointer;
      font-weight:900; letter-spacing:.02em;
      font-size:clamp(1.05rem,2.8vw,1.2rem);
      padding:.75rem 1.4rem; border-radius:999px;
      background:var(--accent); color:#222;
      transition:transform .08s ease, box-shadow .12s ease;
      box-shadow:0 8px 20px rgba(0,0,0,.35);
      touch-action: manipulation;
    }
    #startBtn:active{ transform:translateY(1px); }

    @media (max-width:760px){
      .cta-fixed{
        position:sticky; bottom:0; z-index:50;
        padding:.6rem .8rem calc(.6rem + var(--safe-bottom));
        background:linear-gradient(180deg, transparent 0%, rgba(0,0,0,.55) 45%, rgba(0,0,0,.75) 100%);
        margin:0 -1rem;
      }
      .cta-fixed #startBtn{ width:100%; }
    }

  /* 1) é è¨­ï¼šè¦–è¦ºéš±è—ï¼ˆä»å¯è¢« SR çœ‹è¦‹ã€å¯èšç„¦ï¼‰ */
  .skip-link{
    position:absolute !important;
    width:1px; height:1px;
    padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,0,0);
    white-space:nowrap; border:0;
  }

  /* 2) å–å¾—ç„¦é»ï¼šæ‰é¡¯ç¤ºä¸¦å®šä½åœ¨å·¦ä¸Šè§’ */
  .skip-link:focus,
  .skip-link:focus-visible{
    position:fixed !important;
    left:12px;
    top:12px;         /* ç¬¬äºŒé¡†ä½ å·²å…§è¯ top:56px æœƒè¦†è“‹é€™è£¡ï¼ŒOK */
    z-index:10000;
    clip:auto; width:auto; height:auto; overflow:visible;
    padding:.5rem .75rem; margin:0; white-space:normal; border:2px solid var(--accent);
    border-radius:10px;
    background:#000; color:#fff;
    box-shadow:0 6px 24px rgba(0,0,0,.6);
  }
    @media (hover:none) {
    .skip-link{ /* ä¿æŒ SR å¯èšç„¦å³å¯ï¼Œè¦–è¦ºä»éš±è— */ }
    }

    /* ç„¦é»å¯è¦‹ï¼ˆéµç›¤ï¼‰ */
    [tabindex="-1"]:focus, section:focus, #startBtn:focus {
      outline: 3px solid var(--accent); outline-offset: 2px;
    }

    /* è¦–è¦ºéš±è—ï¼ˆçµ¦ SRï¼‰ */
    .sr-only {
      position:absolute!important; width:1px;height:1px;padding:0;margin:-1px;
      overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0;
    }
  </style>
</head>
<body class="level-intro">
  <!-- éš±è—çš„è·³è½‰é€£çµï¼ˆèšç„¦æ‰é¡¯ç¤ºï¼‰ -->
  <a href="#main" class="skip-link" id="skipToMain" aria-label="è·³åˆ°ä¸»å…§å®¹ï¼Œé–‹å§‹è½æœ¬é—œèªªæ˜">è·³åˆ°ä¸»å…§å®¹</a>
  <a href="#startBtn" class="skip-link" style="top:56px" id="skipToStart" aria-label="è·³åˆ°é–‹å§‹æŒ‰éˆ•ï¼Œç›´æ¥é€²å…¥éŠæˆ²">è·³åˆ°é–‹å§‹æŒ‰éˆ•</a>

  <main class="wrap" id="main" tabindex="-1" aria-label="ç¬¬å››é—œä»‹ç´¹ä¸»å…§å®¹">
    <h1>ç¬¬ 4 é—œï¼šå®¢å»³</h1>

    <!-- A11Y å€å¡Š -->
    <section id="a11yBlock" aria-labelledby="a11yTitle" tabindex="-1">
      <h2 id="a11yTitle">è¢å¹•å ±è®€ä½¿ç”¨è€…å¿…çœ‹</h2>
      <p>
        é€²å…¥é—œå¡å¾Œï¼Œè«‹å…ˆæŒ‰ <span class="kbd">NVDA</span> + <span class="kbd">ç©ºç™½</span> åˆ‡åˆ°<strong>ç„¦é»æ¨¡å¼</strong>ï¼Œå†ç”¨æ–¹å‘éµæ“ä½œã€‚
      </p>
      <ul>
        <li>æ–¹å‘éµï¼š<span class="kbd">â†‘</span> <span class="kbd">â†“</span> <span class="kbd">â†</span> <span class="kbd">â†’</span></li>
        <li>å®šä½è¼”åŠ©ï¼š<span class="kbd">ç©ºç™½éµ</span> æƒæèŸ‘è‚ä½ç½®</li>
        <li>æ­¦å™¨ï¼š<span class="kbd">1</span> å™´ç«æ§ã€<span class="kbd">2</span> é¦™æ°›å™´éœ§ã€<span class="kbd">3</span> è—ç™½æ‹–ã€<span class="kbd">4</span> æ¯’é¤Œ</li>
        <li>æ”»æ“Šï¼š<span class="kbd">Enter</span></li>
        <li>è‹¥æ–¹å‘éµæ²’åæ‡‰ï¼Œè«‹å†æŒ‰ä¸€æ¬¡ <span class="kbd">NVDA</span> + <span class="kbd">ç©ºç™½</span></li>
      </ul>
    </section>

    <!-- å ´åœ°å½¢å¼ -->
    <section>
      <h2>å ´åœ°å½¢å¼</h2>
      <p>7 Ã— 7 æ­£æ–¹å½¢æ ¼å­åœ°åœ–ï¼Œå¯ä¸Šä¸‹å·¦å³ç§»å‹•ï¼Œä½†è¦é¿é–‹å‚¢å…·ä½ç½®ã€‚</p>
    </section>

    <!-- å®¶å…·é…ç½®èˆ‡ç¢°æ’è¦å‰‡ -->
    <section>
      <h2>å®¶å…·ä½ç½®èªªæ˜ âš ï¸ ä¸å¯ç¢°æ’</h2>
      <ul>
        <li>ä¸­å¤®æ²™ç™¼èŒ¶å‡ å€ï¼š<strong>3 Ã— 2</strong>ï¼Œä½æ–¼<strong>ç¬¬ 3â€“4 è¡Œ Ã— ç¬¬ 3â€“5 åˆ—</strong>ï¼ˆå®¢å»³ä¸­å¤®ï¼‰ã€‚</li>
        <li>ä¸‹æ–¹é›»è¦–å€ï¼š<strong>3 Ã— 1</strong>ï¼Œä½æ–¼<strong>ç¬¬ 7 è¡Œ Ã— ç¬¬ 3â€“5 åˆ—</strong>ï¼ˆæœ€ä¸‹æ–¹ä¸­é–“é ç‰†ï¼‰ã€‚</li>
      </ul>
      <p><strong>ğŸ’¥ç¢°æ’è¦å‰‡ï¼š</strong>å®¶å…·çš†ç‚ºéšœç¤™ç‰©ï¼Œ<u>ä¸å¯ç©¿è¶Š</u>ã€‚ç¬¬ä¸€æ¬¡æ’åˆ°æœƒèªéŸ³æé†’ï¼›<u>åŒä¸€å€åŸŸç¬¬äºŒæ¬¡ç¡¬æ’</u>æœƒå—å‚·ï¼Œ<strong>æ‰£ 1 è¡€ã€æ‰£ 1 é‡‘å¹£</strong>ã€‚</p>
    </section>

    <!-- æ–°èŸ‘è‚å“ç¨® -->
    <section>
      <h2>æœ¬é—œå°‡æœƒé‡åˆ°çš„æ–°èŸ‘è‚ ğŸª³</h2>
      <article class="bug" aria-label="è»å¸«èŸ‘åˆ°çˆ†">
        <img src="assets/images/cockroaches/k4.png" alt="è»å¸«èŸ‘åˆ°çˆ†ï¼Œæ‰‹æŒå®¤å…§å¹³é¢åœ–æŒ‡æŒ‡é»é»ï¼ŒæŒ‡æ®å°å…µå‰é€²ã€‚">
        <div>
          <h3 style="margin:.25rem 0 .35rem">è»å¸«èŸ‘åˆ°çˆ†</h3>
          <p>æˆ°è¡“è¬€ç•¥å‹èŸ‘è‚ï¼Œé ˜åœ°æ„Ÿèˆ‡è™Ÿå¬åŠ›è¶…å¼·ï¼Œå«è²æ˜¯ã€Œè¼¸è´ã€ã€‚</p>
          <p>å¼±é»ï¼šæ¯’é¤Œï¼›æˆ–è¢«å‡ºé¡Œè€ƒå€’äººé¡æƒ³æ³•åè¢«ç ´è§£ï¼ˆè§£é¡ŒæˆåŠŸå³å¯æ”¶æœï¼‰ã€‚</p>
        </div>
      </article>
    </section>

    <!-- ç ´é—œç›®æ¨™ -->
    <section id="goalSection" tabindex="-1" aria-labelledby="goalTitle">
      <h2 id="goalTitle">ç ´é—œç›®æ¨™ ğŸ¯</h2>
      <p>ä¿—è¾£å¼· 10 éš»ã€é£›å¤©å¼·å°¼ 10 éš»ã€ä¸»ç®¡å¼·å¼·æ£ 5 éš»ã€è»å¸«èŸ‘åˆ°çˆ† 2 éš»ã€‚</p>
    </section>

    <!-- SR æç¤ºèˆ‡å“¨å…µ -->
    <div id="srHint" class="sr-only" role="status" aria-live="polite"></div>
    <div id="endSentinel" class="sr-only" tabindex="0" aria-label="å·²åˆ°èªªæ˜çµå°¾ï¼Œå°‡å‰å¾€é–‹å§‹æŒ‰éˆ•"></div>

    <!-- CTA -->
    <div class="cta-wrap cta-fixed">
      <button id="startBtn" aria-describedby="startDesc">é€²å…¥ç¬¬å››é—œ</button>
      <span id="startDesc" class="sr-only">æŒ‰ä¸‹å°‡å‰å¾€ç¬¬å››é—œéŠæˆ²ã€‚</span>
    </div>
  </main>

  <!-- BGM -->
  <audio id="bgm" src="assets/sounds/game_04.mp3" loop preload="auto" autoplay muted playsinline></audio>

  <script>
    /* ==== éŸ³è¨Šåˆå§‹åŒ–èˆ‡è§£é–ï¼ˆè¡Œå‹•è£ç½®ï¼‰ ==== */
    AudioFX.init();
    const bgm = document.getElementById('bgm');
    AudioFX.register(bgm);

    (function(){
      let armed = false;
      function fadeIn(audio, vol=0.6, ms=900){
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) { audio.volume = vol; return; }
        audio.volume = 0;
        const steps = 18, delta = vol/steps, step = Math.ceil(ms/steps);
        let i = 0; const t = setInterval(()=>{ i++; audio.volume = Math.min(vol, audio.volume + delta); if(i>=steps) clearInterval(t); }, step);
      }
      function arm(){
        if (armed) return; armed = true;
        try { AudioFX.ensure(); } catch(_){}
        try { bgm.muted = false; } catch(_){}
        bgm.play().then(()=> fadeIn(bgm, .55, 900)).catch(()=>{ /* è‡ªå‹•æ’­æ”¾è¢«æ“‹å°±ä¿æŒéœéŸ³ */ });
        document.removeEventListener('pointerdown', arm, true);
        document.removeEventListener('keydown', arm, true);
      }
      document.addEventListener('pointerdown', arm, true);
      document.addEventListener('keydown', arm, true);
    })();
  </script>

  <script>
    /* ==== å°é  ==== */
    function goLevel4(){
      try { sessionStorage.setItem('needFocusModeHint', '4'); } catch(_){}
      location.href = 'game_04.html';
    }

    /* ==== å¯åŠæ€§èˆ‡å°è¦½ ==== */
    document.addEventListener('DOMContentLoaded', ()=>{
      document.body.classList.add('ready');

      const srHint = document.getElementById('srHint');
      const firstBlock = document.getElementById('a11yBlock');
      const skipMain = document.getElementById('skipToMain');
      const skipStart = document.getElementById('skipToStart');
      const startBtn  = document.getElementById('startBtn');
      const endSentinel = document.getElementById('endSentinel');

      // åˆæ¬¡é€²é ï¼šèšç„¦ç¬¬ä¸€å€å¡Š
      firstBlock?.focus({ preventScroll:true });
      srHint.textContent = 'æç¤ºï¼šé€²å…¥é—œå¡å¾Œï¼Œè«‹æŒ‰ NVDA åŠ  ç©ºç™½ åˆ‡æ›åˆ°ç„¦é»æ¨¡å¼ï¼Œå†ç”¨æ–¹å‘éµæ“ä½œã€‚';

      // Skip â†’ ä¸»å…§å®¹
      function focusFirst(e){ e?.preventDefault(); firstBlock?.focus(); }
      skipMain.addEventListener('click', focusFirst);
      skipMain.addEventListener('keydown', e=>{ if (e.key==='Enter'||e.key===' ') focusFirst(e); });

      // Skip â†’ é–‹å§‹æŒ‰éˆ•
      function focusStart(e){ e?.preventDefault(); startBtn?.focus(); }
      skipStart.addEventListener('click', focusStart);
      skipStart.addEventListener('keydown', e=>{ if (e.key==='Enter'||e.key===' ') focusStart(e); });

      // å…§å®¹å°¾ç«¯ â†’ è‡ªå‹•æŠŠç„¦é»é€åˆ°é–‹å§‹æŒ‰éˆ•
      endSentinel.addEventListener('focus', ()=>{
        srHint.textContent = 'å·²åˆ°èªªæ˜çµå°¾ï¼Œå‰å¾€é–‹å§‹æŒ‰éˆ•ã€‚';
        setTimeout(()=> startBtn?.focus(), 0);
      });

      // åªåœ¨æŒ‰éˆ•èšç„¦æ™‚ï¼ŒEnter/Space æ‰æœƒå•Ÿå‹•
      startBtn.addEventListener('click', goLevel4);
      startBtn.addEventListener('keydown', (e)=>{
        if (e.key==='Enter' || e.key===' '){ e.preventDefault(); goLevel4(); }
      });
    });
  </script>
</body>
</html>
